const CONFIG = require("./config");

module.exports = {
    MP4: [
        "-movflags",
        "+faststart",
        "-preset",
        "ultrafast",
        "-r",
        "30",
        "-tune",
        "zerolatency",
        "-c:v",
        "libx264",
        "-pix_fmt",
        "yuv420p",
        "-b:v",
        "600k",
        "-crf",
        "30",
        "-minrate",
        "300k",
        "-maxrate",
        "600k",
        "-bufsize",
        "1200k",
        "-an",
        "-analyzeduration",
        "512",
        "-probesize",
        "128",
        "-f",
        "mpegts",
    ],

    DASH2: [
        "-y",
        "-an",
        "-vcodec",
        "libx264",
        "-f",
        "dash",
        "-min_seg_duration",
        "1000000",
        "-individual_header_trailer",
        "0",
        "-pix_fmt",
        "yuv420p",
        "-bsf:v",
        "h264_mp4toannexb",
        "-profile:v",
        "high",
        "-level",
        "4.1",
        "-map_chapters",
        "-1",
        "-map_metadata",
        "-1",
        "-preset",
        "veryfast",
        "-movflags",
        "frag_keyframe+empty_moov",
        "-use_template",
        "1",
        "-use_timeline",
        "0",
        "-remove_at_exit",
        "1",
        "-crf",
        "23",
        "-bufsize",
        "7532k",
        "-maxrate",
        "3766k",
        "-start_at_zero",
        "-threads",
        "0",
        "-force_key_frames",
        "expr:if(isnan(prev_forced_t),eq(t,t),gte(t,prev_forced_t+1))",
    ],
    DASH: [
        /* "-movflags",
        "+faststart",
        "-preset",
        "ultrafast",
        "-r",
        "30",
        "-tune",
        "zerolatency",*/
        "-framerate",
        CONFIG.fps,
        "-r",
        CONFIG.fps,
        "-g",
        CONFIG.fps,
        "-c:v",
        "libx264",
        "-pix_fmt",
        "yuv420p",
        "-b:v",
        "600k",
        "-crf",
        "30",
        "-minrate",
        "300k",
        "-maxrate",
        "600k",
        "-bufsize",
        "1200k",
        "-x264opts",
        "keyint=25:scenecut=-1",
        "-an",
        "-f",
        "dash",
        "-window_size",
        "4",
        "-extra_window_size",
        "0",
        "-min_seg_duration",
        "2000000",
        "-use_timeline",
        "1",
        "-remove_at_exit",
        "1",
    ],
    WEBM: ["-c:v", "libvpx", "-r", CONFIG.fps, "-g", CONFIG.fps],
};
